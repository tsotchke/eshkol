;; Test dimensional reduction with full verification

(define (main)
  (printf "=== Dimensional Reduction Verification ===\n")
  
  ;; Create a 2x3 matrix: [[1, 2, 3], [4, 5, 6]]
  (define m1 (matrix 2 3 1 2 3 4 5 6))
  (printf "Original matrix: %s\n" (matrix-to-string m1))
  
  ;; Test dimension 0 reduction (should collapse rows -> [5, 7, 9])
  (define row_sum (tensor-reduce m1 + 0 0))
  (printf "Row sum (dim 0): %s\n" (vector-to-string row_sum))
  (printf "Expected: [5, 7, 9] where 5=1+4, 7=2+5, 9=3+6\n")
  
  ;; Test dimension 1 reduction (should collapse columns -> [6, 15]) 
  (define col_sum (tensor-reduce m1 + 0 1))
  (printf "Column sum (dim 1): %s\n" (vector-to-string col_sum))
  (printf "Expected: [6, 15] where 6=1+2+3, 15=4+5+6\n")
  
  ;; Test max operations
  (define row_max (tensor-reduce m1 max 0 0))
  (printf "Row max (dim 0): %s\n" (vector-to-string row_max))
  (printf "Expected: [4, 5, 6] where each is max of column values\n")
  
  (define col_max (tensor-reduce m1 max 0 1))
  (printf "Column max (dim 1): %s\n" (vector-to-string col_max))
  (printf "Expected: [3, 6] where each is max of row values\n")
  
  0)