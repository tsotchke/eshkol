;; Test dimensional tensor reduction with printf output

(define (main)
  (printf "=== Tensor Dimensional Reduction Test ===\n")
  
  ;; Test tensor-reduce-all (reduces entire tensor to scalar)
  (define v1 (vector 1 2 3 4 5))
  (printf "Vector v1: [1 2 3 4 5]\n")
  
  (define total_sum (tensor-reduce-all v1 + 0))        ;; Should sum all elements
  (printf "Total sum (tensor-reduce-all v1 + 0): %d\n" total_sum)
  
  (define total_product (tensor-reduce-all v1 * 1))    ;; Should multiply all elements
  (printf "Total product (tensor-reduce-all v1 * 1): %d\n" total_product)
  
  (define total_max (tensor-reduce-all v1 max 0))      ;; Should find max
  (printf "Total max (tensor-reduce-all max 0): %d\n" total_max)
  
  ;; Test tensor-reduce with dimension parameter
  ;; Creates a 2x3 matrix: [[1, 2, 3], [4, 5, 6]]
  (printf "\nMatrix m1: [[1, 2, 3], [4, 5, 6]]\n")
  (define m1 (matrix 2 3 1 2 3 4 5 6))
  
  ;; Reduce along dimension 0 (rows -> single row)
  (printf "Reducing along dimension 0 (across rows):\n")
  (define row_sum (tensor-reduce m1 + 0 0))    ;; Sum along rows 
  (printf "Row sum result: %s\n" (vector-to-string row_sum))
  
  (define row_max (tensor-reduce m1 max 0 0))  ;; Max along rows
  (printf "Row max result: %s\n" (vector-to-string row_max))
  
  ;; Reduce along dimension 1 (cols -> single column) 
  (printf "Reducing along dimension 1 (across columns):\n")
  (define col_sum (tensor-reduce m1 + 0 1))    ;; Sum along columns
  (printf "Column sum result: %s\n" (vector-to-string col_sum))
  
  (define col_mean (tensor-reduce m1 mean 0 1)) ;; Mean along columns
  (printf "Column mean result: %s\n" (vector-to-string col_mean))
  
  ;; Test with 1D vector (dimension 0)
  (printf "\nVector v2: [10 5 15 3 8]\n")
  (define v2 (vector 10 5 15 3 8))
  (define v_reduced (tensor-reduce v2 max 0 0))  ;; Find max in vector
  (printf "Vector max along dim 0: %s\n" (vector-to-string v_reduced))
  
  (printf "\n=== All tests completed ===\n")
  0)
