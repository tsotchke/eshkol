;; Validation Suite 2: Computational Graph Construction
;; Tests that operations build complete graphs with proper node connections

(define (test-linear-graph)
  (display "Test 2.1: Linear graph (x + y + z)")
  (newline)
  (define f (lambda (v)
    (+ (+ (vref v 0) (vref v 1)) (vref v 2))))
  (define grad (gradient f (vector 1.0 2.0 3.0)))
  (display "Gradient: ")
  (display grad)
  (newline)
  (display "Expected: vector(1.0, 1.0, 1.0)")
  (newline)
  grad)

(define (test-multiplicative-chain)
  (display "Test 2.2: Multiplicative chain (x * y * z)")
  (newline)
  (define f (lambda (v)
    (* (* (vref v 0) (vref v 1)) (vref v 2))))
  (define grad (gradient f (vector 2.0 3.0 4.0)))
  (display "Gradient: ")
  (display grad)
  (newline)
  (display "Expected: vector(12.0, 8.0, 6.0) - [yz, xz, xy]")
  (newline)
  grad)

(define (test-nested-operations)
  (display "Test 2.3: Nested operations ((x+y)*(x-y))")
  (newline)
  (define f (lambda (v)
    (* (+ (vref v 0) (vref v 1))
       (- (vref v 0) (vref v 1)))))
  (define grad (gradient f (vector 5.0 3.0)))
  (display "Gradient: ")
  (display grad)
  (newline)
  (display "Expected: vector(10.0, -6.0) - [2x, -2y]")
  (newline)
  grad)

(define (main)
  (display "===============================================")
  (newline)
  (display "VALIDATION SUITE 2: Graph Construction")
  (newline)
  (display "===============================================")
  (newline)
  (newline)
  
  (test-linear-graph)
  (newline)
  (test-multiplicative-chain)
  (newline)
  (test-nested-operations)
  
  (newline)
  (display "===============================================")
  (newline)
  (display "Graph Construction Tests Complete")
  (newline)
  (display "===============================================")
  (newline)
  
  0)