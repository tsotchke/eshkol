;; Phase 3 Real AD Operations Test
;; Tests with actual AD operations that build computational graphs

;; Test 1: Gradient of x² at x=3 (should be 6.0)
(define (test-gradient-x-squared)
  (let ((f (lambda (v) (* (vref v 0) (vref v 0)))))
    (let ((grad (gradient f (vector 3.0))))
      (display "Test 1 - Gradient of x² at x=3: ")
      (display (vref grad 0))
      (newline))))

;; Test 2: Gradient of x+y at (2,3) (should be [1.0, 1.0])
(define (test-gradient-sum)
  (let ((f (lambda (v) (+ (vref v 0) (vref v 1)))))
    (let ((grad (gradient f (vector 2.0 3.0))))
      (display "Test 2 - Gradient of x+y at (2,3): [")
      (display (vref grad 0))
      (display ", ")
      (display (vref grad 1))
      (display "]")
      (newline))))

;; Test 3: Gradient of x*y at (2,3) (should be [3.0, 2.0])
(define (test-gradient-product)
  (let ((f (lambda (v) (* (vref v 0) (vref v 1)))))
    (let ((grad (gradient f (vector 2.0 3.0))))
      (display "Test 3 - Gradient of x*y at (2,3): [")
      (display (vref grad 0))
      (display ", ")
      (display (vref grad 1))
      (display "]")
      (newline))))

;; Run all tests
(test-gradient-x-squared)
(test-gradient-sum)
(test-gradient-product)

(display "All gradient tests completed!")
(newline)