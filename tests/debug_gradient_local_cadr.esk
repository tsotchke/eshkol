;; Debug test: gradient with locally-defined cadr
(require stdlib)

;; Define cadr locally (should shadow stdlib)
(define (my-cadr x) (car (cdr x)))

;; Test 1: Use my local cadr
(define (just-y-local v)
  (let ((y (my-cadr v)))
    (* y y)))

(display "Test 1: just-y using local my-cadr")
(newline)
(display "Gradient: ")
(display (gradient just-y-local (vector 3.0 4.0)))
(display " (expected: #(0 8))")
(newline)
(newline)

;; Test 2: Use stdlib cadr
(define (just-y-stdlib v)
  (let ((y (cadr v)))
    (* y y)))

(display "Test 2: just-y using stdlib cadr")
(newline)
(display "Gradient: ")
(display (gradient just-y-stdlib (vector 3.0 4.0)))
(display " (expected: #(0 8))")
(newline)
(newline)

;; Test 3: Inline car/cdr
(define (just-y-inline v)
  (let ((y (car (cdr v))))
    (* y y)))

(display "Test 3: just-y using inline (car (cdr v))")
(newline)
(display "Gradient: ")
(display (gradient just-y-inline (vector 3.0 4.0)))
(display " (expected: #(0 8))")
(newline)

0
