;;
;; Phase 1C Test - Advanced List Operations
;; Testing: remove/remq/remv, last, last-pair
;;

(display "=== PHASE 1C TEST: Advanced List Operations ===")
(newline)

;; Test 1: Remove operations
(display "1. Testing remove operations:")
(newline)
(define test-list (list 1 2 3 2 4 2 5))
(display "   Original list: 1 2 3 2 4 2 5")
(newline)

;; Remove all 2's
(define removed-twos (remove 2 test-list))
(display "   remove 2: ")
(if (null? removed-twos)
    (display "EMPTY")
    (begin
        (display (car removed-twos)) (display " ")
        (display (cadr removed-twos)) (display " ")
        (display (caddr removed-twos)) (display " ")
        (display (car (cdr (cdr (cdr removed-twos)))))
    ))
(newline)

;; Test remq (should work same as remove for integers)
(define remq-twos (remq 2 test-list))
(display "   remq 2: ")
(if (null? remq-twos)
    (display "EMPTY")
    (begin
        (display (car remq-twos)) (display " ")
        (display (cadr remq-twos)) (display " ")
        (display (caddr remq-twos)) (display " ")
        (display (car (cdr (cdr (cdr remq-twos)))))
    ))
(newline)

;; Test 2: Remove non-existing element
(display "2. Testing remove non-existing:")
(newline)
(define removed-nines (remove 9 test-list))
(display "   remove 9: ")
(display (car removed-nines)) (display " ")
(display (cadr removed-nines)) (display " ")
(display (caddr removed-nines))
(newline)

;; Test 3: Last function
(display "3. Testing last function:")
(newline)
(define test-nums (list 10 20 30 40 50))
(display "   Numbers: 10 20 30 40 50")
(newline)

(define last-num (last test-nums))
(display "   last: ")
(display last-num)
(newline)

;; Test last with single element
(define single-list (list 42))
(define last-single (last single-list))
(display "   last of (42): ")
(display last-single)
(newline)

;; Test 4: Last-pair function
(display "4. Testing last-pair function:")
(newline)
(define last-pair-result (last-pair test-nums))
(display "   last-pair: ")
(if (null? last-pair-result)
    (display "EMPTY")
    (begin
        (display "(")
        (display (car last-pair-result))
        (display ")")
    ))
(newline)

;; Test last-pair with single element
(define last-pair-single (last-pair single-list))
(display "   last-pair of (42): ")
(if (null? last-pair-single)
    (display "EMPTY")
    (begin
        (display "(")
        (display (car last-pair-single))
        (display ")")
    ))
(newline)

;; Test 5: Edge cases
(display "5. Testing edge cases:")
(newline)

;; Remove from empty list
(define empty-list (list))
(define remove-empty (remove 1 empty-list))
(display "   remove from empty: ")
(if (null? remove-empty) (display "EMPTY") (display "NOT EMPTY"))
(newline)

;; Remove all elements
(define all-twos (list 2 2 2))
(define remove-all (remove 2 all-twos))
(display "   remove all elements: ")
(if (null? remove-all) (display "EMPTY") (display "NOT EMPTY"))
(newline)

(display "=== PHASE 1C COMPLETE SUCCESS! ===")
(newline)
