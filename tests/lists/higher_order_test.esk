;;
;; Higher-Order Functions Test
;; Testing map, filter, fold, make-list, member functions
;;

(require stdlib)

;; Test make-list
(display "Testing make-list:")
(newline)
(define zeros (make-list 5 0))
(display "make-list 5 zeros: ")
(display (car zeros)) (display " ") 
(display (cadr zeros)) (display " ") 
(display (caddr zeros))
(display " (length: ") (display (length zeros)) (display ")")
(newline)

(define ones (make-list 3 1))
(display "make-list 3 ones: ")
(display (car ones)) (display " ") 
(display (cadr ones)) (display " ") 
(display (caddr ones))
(newline)

;; Test member
(display "Testing member:")
(newline)
(define test-list (list 10 20 30 40))
(define found-20 (member 20 test-list))
(display "member 20 in [10,20,30,40]: ")
(display (car found-20)) (display " ") (display (cadr found-20))
(newline)

(define not-found (member 99 test-list))
(display "member 99 in [10,20,30,40]: ")
(display (null? not-found))
(newline)

;; Test map with builtin function
(display "Testing map:")
(newline)
(define numbers (list 1 2 3 4))
(define doubled (map + numbers))
(display "map + on [1,2,3,4]: ")
(display (car doubled)) (display " ") 
(display (cadr doubled)) (display " ") 
(display (caddr doubled)) (display " ") 
(display (car (cdr (cdr (cdr doubled)))))
(newline)

(display "Higher-order functions test completed!")
(newline)
