; Lambda S-Expression Homoiconic Display Test
; Tests that lambdas display as (lambda (params) body) instead of <function>

(require stdlib)

; Test 1: Simple lambda display
(define square (lambda (x) (* x x)))
(display square)
(newline)

; Test 2: Multi-parameter lambda
(define my-add (lambda (x y) (+ x y)))
(display my-add)
(newline)

; Test 3: Lambda execution still works
(display (square 5))
(newline)
(display (my-add 3 7))
(newline)

; Test 4: Closure with captured variable
(define make-adder (lambda (n)
  (lambda (x) (+ x n))))
(define add5 (make-adder 5))
(display add5)
(newline)
(display (add5 10))
(newline)

; Test 5: Lambda in list structure
(define funcs (list 
  (lambda (x) (* x 2))
  (lambda (x) (+ x 1))
  (lambda (x) (- x 1))))
(display funcs)
(newline)

; Test 6: Map with lambda (execution must still work)
(define doubled (map (lambda (x) (* x 2)) (list 1 2 3 4)))
(display doubled)
(newline)

; Test 7: Filter with lambda (execution must still work)
(define evens (filter (lambda (x) (= (% x 2) 0)) (list 1 2 3 4 5 6)))
(display evens)
(newline)

; Test 8: Nested lambda display
(define curried-add (lambda (x) (lambda (y) (+ x y))))
(display curried-add)
(newline)

; Test 9: Lambda passed as argument
(define apply-twice (lambda (f x) (f (f x))))
(display (apply-twice square 2))
(newline)

; Test 10: Symbolic diff returns S-expression (existing feature)
(display (diff (* x x) x))
(newline)

; SUCCESS CRITERIA:
; - square displays as: (lambda (x) (* x x))
; - my-add displays as: (lambda (x y) (+ x y))
; - add5 displays as: (lambda (x) (+ x n))  ; capture visible in source
; - funcs displays as: ((lambda (x) (* x 2)) (lambda (x) (+ x 1)) (lambda (x) (- x 1)))
; - All executions return correct numeric values
; - map/filter produce correct results
; - Symbolic diff shows: (* 2 x)