;;
;; Phase 2A Multi-List Map Test - Testing multi-list higher-order functions
;;

(display "=== PHASE 2A MULTI-LIST MAP TEST ===")
(newline)

;; Test 1: Basic multi-list map with addition
(display "1. Testing multi-list map with addition:")
(newline)
(define list1 (list 1 2 3))
(define list2 (list 4 5 6))
(display "   List 1: 1 2 3")
(newline)
(display "   List 2: 4 5 6")
(newline)

;; Simple + function should work for multi-list map
(define result1 (map + list1 list2))
(display "   map + result: ")
(if (null? result1)
    (display "EMPTY")
    (begin
        (display (car result1)) (display " ")
        (display (cadr result1)) (display " ")
        (display (caddr result1))
    ))
(newline)

;; Test 2: Multi-list map with different lengths (stops at shortest)
(display "2. Testing multi-list map with different lengths:")
(newline)
(define short-list (list 10 20))
(define long-list (list 1 2 3 4 5))
(display "   Short list: 10 20")
(newline)
(display "   Long list: 1 2 3 4 5")
(newline)

(define result2 (map + short-list long-list))
(display "   map + result (should have 2 elements): ")
(if (null? result2)
    (display "EMPTY")
    (begin
        (display (car result2)) (display " ")
        (display (cadr result2))
    ))
(newline)

;; Test 3: Three lists
(display "3. Testing three-list map:")
(newline)
(define list3 (list 100 200 300))
(display "   List 3: 100 200 300")
(newline)

;; For now, test with simple predefined function since lambda resolution might be complex
(define result3 (map + list1 list2 list3))
(display "   map + three lists result: ")
(if (null? result3)
    (display "EMPTY")
    (begin
        (display (car result3)) (display " ")
        (display (cadr result3)) (display " ")
        (display (caddr result3))
    ))
(newline)

(display "=== PHASE 2A MULTI-LIST MAP SUCCESS! ===")
(newline)
